<tool id="exportGeneListToEuPathDB" name="Gene List to EuPathDB" version="1.0.0">
  <description>Export a gene list to EuPathDB</description>
  <stdio>
    <exit_code range="65" level="fatal" description="Dataset Validation Failure" />
    <exit_code range="74" level="fatal" description="iRODS Rest Service Failure" />
  </stdio>
  <command>
    python $__tool_directory__/exportGeneListToEuPathDB.py "$dataset_name" "$summary" "$description" "$input" "$output" "$user_id"
  </command>
  <inputs>
    <param name="dataset_name" type="text" size="100" value=""
           label="EuPathDB dataset name:"
           help="This name will allow you to readily identify and apply this dataset in EuPathDB">
      <validator type="empty_field" />
      <validator type="regex" message="Only letters, numbers, spaces and dashes are allowed in the name.">^[\w\d\s\-]*$</validator>
      <validator type="length" message="Please restrict the name to 100 characters or less." max="100" />
    </param>
    <param name="summary" type="text" value=""
           label="EuPathDB dataset summary:"
           help="This summary will appear in your EuPathDB dataset listing page. Note that any double quotes will be coverted to single quotes">
      <validator type="empty_field" />
      <sanitizer>
        <valid initial="string.printable">
          <remove value="&quot;"/>
        </valid>
        <mapping initial="none">
          <add source="&quot;" target="'"/>
        </mapping>
      </sanitizer>
    </param>
    <param name="description" type="text" value="" area="True"
           label="EuPathDB dataset description:"
           help="This description is visible on the EuPathDB dataset page reached via the dataset listing page.  Note that any double quotes will be coverted to single quotes" >
      <validator type="empty_field" />
      <sanitizer>
        <valid initial="string.printable">
          <remove value="&quot;"/>
        </valid>
        <mapping initial="none">
          <add source="&quot;" target="'"/>
        </mapping>
      </sanitizer>
    </param>
    <!--
     multiple = false by default.  If the user select N files, the tool runs N times.  This is
     a problem since the accompanying information will be the same each time.
     -->
    <param name="input" type="data" format="txt" label="Gene list to export:" >
      <validator type="empty_dataset" />
    </param>
    <param name="user_id" type="hidden" value="$__user_id__" />
  </inputs>
  <outputs>
      <data format="txt" name="output" label="exportToEuPathDBInfo.txt" />
  </outputs>
  <tests>
    <!-- Haven't been able to get this to work using planemo t -->
    <test>
      <param name="datasetName" value="Sample Dataset"/>
      <param name="summary" value="A sample dataset summary"/>
      <param name="description" value="A sample dataset description" />
      <param name="project" value="plasmoDB" />
      <param name="input" value="genelist.txt" />
      <output name="output" file="output.txt" />
      <!-- user id for Cris -->
      <param name="user_id" value="108976930" />
    </test>
  </tests>

    <help>

**What it does**

This tool obtains a gene list and from that, creates a valid EuPathDB dataset that will be exported to one or
more EuPathDB projects as per the user's project selection.

You need to provide a name for the dataset so that you may easily identify it in EuPathDB websites, along with
a description and a summary, the project to which the dataset applies and of course, a gene list. All inputs are
required.

-----

**Example**

Here is an example of a properly filled in form:
      
.. image:: ${static_path}/images/geneListToolDemo.png
        :height: 200
        :width: 500

.. class:: warningmark

We recommend that the user only supply one dataset file at a time. The tool can run in batch mode,
but the datasets could be very difficult to distinguish in EuPathDB as all the other parameters above
will apply to every dataset.

</help>
<citations>
  <citation type="doi">
    10.1093/nar/gkw1105
  </citation>
</citations>
</tool>
